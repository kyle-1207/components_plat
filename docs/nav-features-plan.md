

📄 平台开发需求文档（优化整合版）

一、修订与补充说明

本次修订在您详实的文档基础上，着重增强了方案的可执行性、可测试性和可维护性。补充的核心内容旨在明确开发前的规则，减少开发过程中的歧义和返工，并为未来运维提供清晰依据。

二、总体原则（补充与细化）

1.  体验一致：统一导航与面包屑、统一搜索条样式、统一权限与消息提示。
2.  API 一致：REST 风格，错误码统一，分页与排序参数统一。
3.  性能可控：热点接口加缓存，分面截断，分页必须索引。
4.  安全与合规：登录态/JWT，占位权限模型，敏感操作审计日志。
5.  角色与权限模型（RBAC）：
    ◦   用户角色：定义访客、注册用户、标准管理员、质量工程师、采购员、系统管理员等核心角色。

    ◦   权限粒度：初期实现功能权限（菜单、按钮），规划数据权限（如：不同用户仅能查看和处理其所属项目或部门的数据）。

    ◦   授权管理：提供角色管理、权限分配、用户角色指派等功能界面，确保权限可控可配。

6.  非功能性需求量化指标：
    ◦   性能：核心业务接口（如器件查询、清单导出）P95响应时间 < 500ms，P99 < 2s。

    ◦   可用性：系统核心功能月度可用性不低于 99.9%。

    ◦   数据准确性：关键业务数据（如器件参数、标准条款）在系统中的准确率要求达到100%。

三、模块需求概要（关键补充与优化）

1) 标准服务（标准文档与合规）

• 目标：集中管理 MIL/ESCC/ISO/GB 等标准文档，支持搜索、版本管理和合规检查，并与器件/试验/采购联动。

• 核心功能：

    ◦ 标准库：分类（体系/领域/版本），全文/关键词搜索，标签；版本/替代链；状态（现行/废止/替代）。

    ◦ 合规关联：标准条款与器件/型号/批次关联；基于器件或批次生成合规检查结果。

    ◦ 下载与权限：受控下载、访问权限、下载日志；水印占位。

• 关键业务规则：

    ◦ 版本管理：新标准版本发布后，系统应能明确提示受影响的器件清单，并支持合规人员批量更新关联关系。

    ◦ 替代关系：标准替代关系需明确类型（如“等效采用”、“修改采用”），并在查询详情时清晰展示。

• 数据与接口要点：

    ◦ 元数据：标准号、名称、版本、状态、发布日期、替代关系、文件指针。

    ◦ 关联：standard_id ↔ component_id/sku_id/batch_id；可溯源到试验报告/质量事件。

    ◦ 接口：标准搜索、详情、版本列表、替代链、关联查询、合规检查结果拉取。

• 前端交互：

    ◦ 目录+搜索+过滤（体系/状态/发布日期）。

    ◦ 详情页：版本切换、替代提示、关联器件列表、关联试验/质量/采购入口。

    ◦ 合规结果：可导出，按器件/批次筛选。

• 验收：

    ◦ 搜索响应 <500ms；版本/替代链正确；合规关联可查可导出；权限/下载日志有效。

2) 器件查询（核心搜索、分面、对比、清单）

• 目标：分类/关键词/参数搜索，分面筛选，组件详情，对比，清单（DCL/BOM），快速报价入口。

• 核心功能：

    ◦ 搜索与分面：分类树、制造商、质量/库存/生命周期等分面（详见 facets-plan）；分页、排序、导出。

    ◦ 详情：基本信息、参数、相关标准、试验/质量事件摘要、供应/库存占位、资料下载入口。

    ◦ 对比（Comparator 对标）：多选组件参数对比，差异高亮，导出对比报告。

    ◦ 清单（DCL/BOM）：将器件加入清单，支持导入/导出、分享。

    ◦ 快速报价入口：从详情或清单触发 RFQ/报价请求（跳转采购服务）。

• 关键业务规则与交互：

    ◦ 搜索无结果处理：明确无结果时的界面提示，并提供相关搜索建议或热门器件推荐。

    ◦ 参数校验：对用户输入的参数范围进行有效性校验和友好提示。

• 前端交互：

    ◦ 左滤右表，分面多选+chips 清除；“展开更多”分面。

    ◦ 对比选择框、对比抽屉/页面；清单加入/查看；最近浏览/收藏。

• 验收：

    ◦ 分面排序/缓存/分页正常；对比可用；清单导入导出正常；RFQ 跳转畅通。

3) 采购服务（Proposal Next / RFQ / 订单）

• 目标：支持“添加清单或购物车式 RFQ”→ 询价/报价 → 确认/下单/跟踪；对标 doEEEt Proposal Next 与 ESA Stockplace 风格的特定项目库存入口。

• 核心功能：

    ◦ RFQ 创建：从搜索/详情/清单加入；支持文件上传（BOM/DCL）；供应商多选或系统分派。

    ◦ 报价收集与对比：价格、交期、MOQ、币种、有效期；对比视图；导出。

    ◦ 订单/意向单：下单占位，交付状态（在产/在途/到货），异常记录。

    ◦ 项目/库存入口：特定项目库存（类似 ESA Stockplace）查询与申请。

• 关键业务流程与状态机：

    ◦ RFQ状态流：草稿 → 已发出 → 报价中 → 已截止 → 已确认（生成订单）→ 已完成/已关闭。

    ◦ 超时与取消规则：明确RFQ报价截止时间，超时后自动关闭；定义买卖双方取消RFQ的条件和审批流程。

• 数据与接口要点：

    ◦ 模型：需求/报价/订单；清单项与器件关联；供应商信息。

    ◦ 流程：状态流转（草稿→询价→报价→确认→关闭/下单），操作日志。

    ◦ 附件：RFQ/BOM 上传元数据；报价单附件指针。

• 前端交互：

    ◦ RFQ 表单（支持上传）；报价对比表；状态时间线；导出。

    ◦ “添加到 RFQ/购物车”入口复用全站。

• 验收：

    ◦ RFQ→报价→确认链路可走通；报价对比/导出可用；状态可追踪；项目库存入口可查询可申请。

4) 应用支持（资源、博客/活动、咨询）

• 目标：提供设计辅助与技术支持资源，包含技术博客、活动/研讨会、工单/咨询，数字模型入口。

• 核心功能：

    ◦ 资源库：按场景/器件类型筛选，搜索；下载权限、记录。

    ◦ 技术博客/活动：列表、分类、搜索、详情、报名/回看/资料下载。

    ◦ 咨询/工单：创建、分派、状态（待响应/处理中/已解决）、追问记录。

    ◦ 数字模型元数据：IBIS/SPICE/S 参数/热仿真模型入口，占位下载。

• 工单SLA（服务等级协议）：

    ◦ 定义不同优先级工单的初始响应时间（如P1紧急问题需在2小时内响应）和解决目标时间。

• 数据与接口要点：

    ◦ 元数据：标题、标签、关联器件、版本/时间、附件。

    ◦ 工单：分类、优先级、状态、处理人、日志。

• 前端交互：

    ◦ 资源筛选/搜索；下载提示；活动报名/回看；工单时间线。

• 验收：

    ◦ 资源可筛选下载且有记录；活动可报名/回看；工单可创建、查询、更新状态。

5) 质量管理（事件全生命周期）

• 目标：质量事件全生命周期管理，并与器件、批次、试验、供应商表现联动。

• 核心功能：

    ◦ 质量问题上报：分类、严重度、批次/器件关联、证据上传。

    ◦ 流程与分配：状态（新建/分析/整改/验证/关闭），指派、超时提醒。

    ◦ 归零/措施：根因分析占位、纠正措施、验证记录。

    ◦ 通报：范围控制、阅读确认；与关联器件/供应商/批次联动。

    ◦ 报表：问题清单、状态分布、按供应商/批次统计。

• 关键流程与追溯性：

    ◦ 事件编号：为每个质量事件生成唯一、可追溯的业务编号（如QE-2025-00001）。

    ◦ 转派与升级：明确当初始指派人员无法处理时，事件的转派规则和升级路径（如超时未处理自动升级至上级主管）。

• 验收：

    ◦ 上报→关闭链路通；指派/提醒记录；通报可发布/确认；关联查询可达。

6) 试验检测（Laboratory Services 对标）

• 目标：管理试验申请、计划、执行与报告，对标 Laboratory Services，可支持多测试项组合报价。

• 核心功能：

    ◦ 试验申请：类型（TID/SEE/DD/常规等）、样品/条件、期望时间；可组合多项。

    ◦ 报价/审批：对申请出报价，审批后进入计划。

    ◦ 计划与执行：排期、状态（待排期/进行中/已完成）、实验室/设备信息。

    ◦ 报告管理：报告元数据、版本、下载权限；结果摘要。

    ◦ 数据上传占位：原始数据元数据。

• 组合报价逻辑：

    ◦ 明确多个测试项组合时的报价规则（是单价求和，还是存在套餐价），并在申请界面清晰展示。

• 验收：

    ◦ 申请→报价→计划→报告链路通；状态正确；报告可下载（权限提示）；多测试项可组合。

7) 资料培训（课程/资料、活动/研讨）

• 目标：集中培训与资料下载，记录学习行为；支持活动/研讨会报名与回看。

• 核心功能：

    ◦ 课程/资料库：按主题/角色/模块分类；搜索；下载/在线观看。

    ◦ 活动/研讨：报名、日历、回看、资料下载。

    ◦ 进度与记录：学习完成度占位，下载记录。

• 验收：

    ◦ 课程/资料可搜可下/可看；活动可报名回看；记录可查询。

8) 首页与全局

• 目标：统一入口、快速搜索、推荐与跳转。

• 核心功能：

    ◦ 全局搜索框：跳转到器件查询页并带入关键字。

    ◦ 快捷入口：Comparator（对比）、BOM/DCL 清单、报价请求、试验检测申请、标准库、活动/博客。

    ◦ 热门搜索/推荐；公告/通告。

• 验收：

    ◦ 搜索跳转正确；入口可达；公告可见可配置。

四、技术与非功能需求（补充与细化）

• API 统一：分页、排序、错误码、鉴权头一致；OpenAPI 契约。

• 缓存：分类树与 facets 使用 Redis；RFQ/报价列表可缓存短 TTL；空结果短 TTL 防穿透。

• 索引：按查询条件建立（familyPath、manufacturer、quality_grade、stock_status、lifecycle 等）；RFQ/订单/试验申请按状态+时间索引；慢查询跟踪。

• 安全：JWT 登录；基础权限占位；下载/导出记录；输入输出校验（前端 DOMPurify 用于富文本/HTML）；文件上传校验（BOM/DCL）。

• 日志与监控：请求/错误日志、缓存命中率、关键接口 P95；审计操作（创建/更新/下载/导出/上传）；RFQ/试验/质量流程的状态日志。

• 审计与追溯性要求：

    ◦ 所有核心业务实体（RFQ、质量事件、试验申请等）需有唯一业务编号。

    ◦ 所有敏感数据（如标准文档、器件参数）的关键变更（创建、修改、删除）必须记录操作人、时间戳、变更前后的值（必要时）及变更原因。

• 外部依赖与降级方案：

    ◦ 明确依赖：列出关键外部系统，如企业统一用户认证系统（如LDAP/AD）、供应商门户接口、邮件/通知服务、对象存储服务等。

    ◦ 降级方案：定义关键依赖不可用时的预案，如认证服务故障时的备用登录机制；邮件服务失败时，系统内消息中心必须保证通知可达。

• 部署与监控要点：

    ◦ 环境要求：明确开发、测试、生产环境的服务器配置、中间件版本等基线要求。

    ◦ 监控报警：定义关键监控指标（如订单积压数量、登录失败率、API错误率）及报警阈值。

    ◦ 数据备份：制定关键业务数据（如用户数据、器件库、订单数据）的备份策略与恢复演练计划。

• 智能化数据与上线准备：

    ◦ 埋点与标签：采集搜索/点击/对比/收藏/清单/导出/RFQ/下单/下载/阅读等行为，建立用户画像与物料画像（参数、分类、质量、生命周期、供应信息）。

    ◦ 冷启动策略：先用规则/内容相似推荐与热门榜单；行为数据充足后再启用学习排序（L2R）与协同过滤；对个性化分面/排序提供“关闭个性化”兜底。

    ◦ 评估指标：搜索与推荐用 CTR/NDCG；分面点击率提升；RFQ 转化率；错误率与时延作为上线闸口。

• 状态机与超时（需出图/表明确）：

    ◦ RFQ/订单：草稿 → 已发出 → 报价中 → 已截止 → 已确认/关闭 → 订单/意向单；含超时关闭规则与取消条件。

    ◦ 质量事件：新建 → 分析 → 整改 → 验证 → 关闭/误报；含转派与升级路径、超时提醒。

    ◦ 试验申请：草稿 → 审批/报价 → 计划 → 进行中 → 完成/关闭；多测试项组合报价规则。

• API 契约与版本：

    ◦ 统一分页/排序/过滤参数命名；错误码表与错误体格式；请求超时与幂等策略（如幂等键用于创建类接口）。

    ◦ OpenAPI 契约为准，核心接口建议版本化（/api/v1/...）。

• SLO/SLA 与监控：

    ◦ 关键流（搜索、RFQ、质量、试验）的 P95/P99、可用性、错误率设定阈值并接入报警；缓存命中率监控。

• 测试与验收清单（最小集）：

    ◦ 功能：搜索/分面/对比/清单导入导出、RFQ 流转、质量事件流转、试验申请到报告、下载权限与日志。

    ◦ 性能：核心接口 P95<500ms，P99<2s；高并发下缓存命中率与降级验证。

    ◦ 安全：权限隔离、敏感字段脱敏/水印、上传校验、XSS/注入防护。

• 部署与环境基线：

    ◦ 中间件版本：Mongo/Redis 版本、端口、内存/CPU 建议；备份与恢复演练频次（至少月度）。

    ◦ 外部依赖：认证、通知、对象存储等不可用时的降级方案（如站内信替代邮件）。

五、项目与项目管理补充

1.  需求评审与确认机制：
    ◦   建立由产品负责人（PO）、开发负责人（Tech Lead）、测试负责人（QA Lead）参与的三方评审与会签机制，确保在开发启动前对需求理解一致。

    ◦   需求定稿后形成需求基线，后续变更需走正式的变更控制流程（即使简化），评估影响范围后再实施。

2.  术语表（示例）：
    ◦   器件 (Component)：指平台管理的核心电子元器件。

    ◦   批次 (Batch)：指具有相同生产标识的器件集合。

    ◦   RFQ (Request for Quotation)：报价请求，指一次完整的询价流程。

    ◦   合规检查 (Compliance Check)：依据标准条款对器件或批次符合性的自动或人工检查。

3.  阶段规划（可选）：
    ◦   MVP (Minimum Viable Product) 阶段：明确首期上线的核心模块与功能范围，例如聚焦器件查询、标准库浏览、基础RFQ流程。

    ◦   后续迭代：逐步上线质量管理、试验检测等复杂模块，并引入智能化推荐功能。

