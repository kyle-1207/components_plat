# 功能完整性测试清单

## 测试目标
在打包生产版本前，确保所有核心功能正常工作，减少生产环境 bug。

## 测试环境要求
- 后端服务运行在 `http://localhost:3001`
- 前端服务运行在 `http://localhost:3000`
- MongoDB 数据库已连接并包含测试数据
- Redis 缓存服务已启动（如使用）
- 附件文件已索引（标准文件、国产元器件附件）

---

## 一、标准服务功能测试

### 1.1 标准查询页面 (`/standards/query`)

#### ✅ 测试项 1.1.1：基础搜索功能
- [ ] **关键词搜索**
  - 输入标准编号：`MIL-STD-883H`
  - 输入标准名称关键词：`MICROCIRCUITS`
  - 验证：搜索结果正确显示，包含匹配的标准

- [ ] **分类筛选**
  - 选择分类：`MIL-STD`
  - 验证：只显示该分类下的标准

- [ ] **状态筛选**
  - 选择状态：`active`（现行）
  - 验证：只显示现行标准

- [ ] **年份筛选**
  - 选择发布年份：`2010`
  - 验证：只显示该年份发布的标准

- [ ] **组合筛选**
  - 同时使用多个筛选条件
  - 验证：结果符合所有筛选条件

#### ✅ 测试项 1.1.2：分页功能
- [ ] **分页导航**
  - 点击"下一页"、"上一页"
  - 修改每页显示数量（20/50/100）
  - 验证：分页正确，数据正确显示

- [ ] **分页统计**
  - 验证：显示正确的总数和当前页信息

#### ✅ 测试项 1.1.3：标准详情页
- [ ] **基本信息显示**
  - 点击标准编号打开详情
  - 验证：显示所有基本信息字段
    - 标准编号、标准类型、版本、状态
    - 发布日期、生效日期（只显示年月日）
    - 发布组织、适用范围、标题、描述

- [ ] **版本历史**
  - 切换到"版本历史"标签页
  - 验证：显示版本历史信息（如有）

- [ ] **统计信息**
  - 切换到"统计信息"标签页
  - 验证：显示查看次数、下载链接

#### ✅ 测试项 1.1.4：标准文件下载功能 ⭐
- [ ] **下载按钮测试**
  - 点击表格中的"下载"按钮
  - 点击详情页中的"下载标准文档"按钮
  - 验证：
    - 文件能够正常下载
    - 文件名正确（与 standardCode 匹配）
    - 下载的文件是 PDF 格式

- [ ] **文件不存在处理**
  - 测试没有对应文件的标准
  - 验证：显示友好的错误提示

- [ ] **附件索引验证**
  - 执行索引操作：`POST /api/standards/attachments/reindex`
  - 验证：索引成功，返回正确的文件数量

#### ✅ 测试项 1.1.5：数据格式验证
- [ ] **日期格式**
  - 验证：发布日期和生效日期只显示年月日（YYYY-MM-DD）
  - 验证：不是完整的 ISO 时间戳

- [ ] **空字段处理**
  - 验证：空字段显示为 `-` 或 `暂无描述` 等友好提示
  - 验证：不会出现 `undefined` 或 `null`

---

## 二、元器件搜索功能测试

### 2.1 进口元器件搜索 (`/components/search?source=import`)

#### ✅ 测试项 2.1.1：基础搜索功能
- [ ] **型号搜索**
  - 输入型号：`5962-8864203YA`
  - 验证：搜索结果正确

- [ ] **制造商筛选**
  - 选择制造商：`Pyramid Semiconductor`
  - 验证：只显示该制造商的元器件

- [ ] **质量等级筛选**
  - 选择质量等级：`883`、`QML Q`、`EP`
  - 验证：筛选结果正确

- [ ] **库存状态筛选**
  - 选择：`Yes`（有库存）
  - 验证：只显示有库存的元器件

- [ ] **淘汰状态筛选**
  - 选择：`Active`（现行）
  - 验证：只显示现行元器件

#### ✅ 测试项 2.1.2：分类筛选
- [ ] **分类树加载**
  - 验证：左侧分类树正确加载
  - 验证：显示15个顶层分类

- [ ] **分类选择**
  - 选择分类：`Resistors > Film`
  - 验证：搜索结果自动更新
  - 验证：只显示该分类下的元器件

- [ ] **分类统计**
  - 验证：每个分类显示正确的数量

#### ✅ 测试项 2.1.3：动态参数表头
- [ ] **参数列显示**
  - 验证：根据分类动态显示参数列
  - 验证：有 `short_name` 的参数显示简写 + Tooltip
  - 验证：无 `short_name` 的参数显示完整名称

- [ ] **参数值显示**
  - 验证：参数值正确显示
  - 验证：空值显示为 `-` 或 `--`

#### ✅ 测试项 2.1.4：元器件详情
- [ ] **详情弹窗**
  - 点击元器件型号打开详情
  - 验证：显示基本信息、参数详情

- [ ] **参数展示**
  - 验证：参数表格正确显示
  - 验证：参数名称、值、分类正确

#### ✅ 测试项 2.1.5：元器件对比功能
- [ ] **多选功能**
  - 选择2-5个元器件
  - 验证：复选框正确工作

- [ ] **对比弹窗**
  - 点击"批量对比"按钮
  - 验证：对比表格正确显示
  - 验证：基本信息对比正确
  - 验证：参数对比矩阵正确

#### ✅ 测试项 2.1.6：CSV导出功能
- [ ] **导出功能**
  - 点击"导出CSV"按钮
  - 验证：CSV文件正确下载
  - 验证：包含所有列（静态列 + 动态参数列）
  - 验证：中文编码正确（UTF-8 BOM）

### 2.2 国产元器件搜索 (`/components/search?source=domestic`)

#### ✅ 测试项 2.2.1：基础搜索功能
- [ ] **关键词搜索**
  - 输入型号、厂商、分类关键词
  - 验证：搜索结果正确

- [ ] **分类筛选**
  - 验证：显示国产分类树（11个一级分类）
  - 选择分类：`通用与特种元件 > 电容器 > 无机介质固定电容器`
  - 验证：搜索结果正确

#### ✅ 测试项 2.2.2：国产元器件详情
- [ ] **详情显示**
  - 点击元器件打开详情
  - 验证：显示所有字段
    - 型号、厂商、分类（level1/2/3）
    - 质量等级、航天供货、是否主推
    - 关键性能、温度范围、抗辐照、封装等

#### ✅ 测试项 2.2.3：国产元器件附件下载 ⭐
- [ ] **附件下载**
  - 点击表格中的"附件"列下载按钮
  - 点击详情页中的"附件"卡片下载按钮
  - 验证：
    - 文件能够正常下载
    - 文件名与 `material_code` 匹配
    - 下载的文件是 PDF 格式

- [ ] **附件不存在处理**
  - 测试没有附件的元器件
  - 验证：显示"未找到附件文件"提示

#### ✅ 测试项 2.2.4：国产元器件对比功能
- [ ] **对比功能**
  - 选择2-5个国产元器件
  - 点击"批量对比"
  - 验证：
    - 对比表格正确显示
    - 功能描述正确显示
    - 参数详情正确显示（key_specs、temperature_range、radiation等）

#### ✅ 测试项 2.2.5：Source 推断逻辑
- [ ] **URL参数推断**
  - 访问 `/components/search?source=domestic`
  - 验证：正确显示国产分类树和搜索结果

- [ ] **Referrer推断**
  - 从国产供应商搜索页面跳转
  - 验证：自动识别为 `domestic` source

- [ ] **搜索结果推断**
  - 搜索国产元器件
  - 验证：根据搜索结果自动推断 source

---

## 三、首页功能测试

### 3.1 首页统计卡片 (`/`)

#### ✅ 测试项 3.1.1：分类统计
- [ ] **统计卡片显示**
  - 验证：显示11个主要分类的统计卡片
  - 验证：每个卡片显示正确的数量

- [ ] **点击跳转**
  - 点击分类卡片
  - 验证：跳转到对应的搜索页面

#### ✅ 测试项 3.1.2：全局搜索
- [ ] **搜索功能**
  - 输入关键词搜索
  - 验证：搜索结果正确
  - 验证：支持源切换（进口/国产）

---

## 四、API接口测试

### 4.1 标准服务API

#### ✅ 测试项 4.1.1：标准搜索API
```bash
GET /api/standards/search?standardType=MIL&page=1&limit=20&category=MIL-STD
```
- [ ] 验证：返回正确的标准列表
- [ ] 验证：分页信息正确
- [ ] 验证：筛选条件生效

#### ✅ 测试项 4.1.2：标准详情API
```bash
GET /api/standards/:id
```
- [ ] 验证：返回完整的标准信息
- [ ] 验证：日期格式正确

#### ✅ 测试项 4.1.3：标准附件API ⭐
```bash
# 附件索引
POST /api/standards/attachments/reindex

# 获取附件信息
GET /api/standards/:standardCode/attachment

# 下载附件
GET /api/standards/:standardCode/download
```
- [ ] 验证：索引操作成功
- [ ] 验证：附件信息查询正确
- [ ] 验证：文件下载正常

### 4.2 元器件搜索API

#### ✅ 测试项 4.2.1：进口元器件搜索API
```bash
GET /api/doeeet/search?partNumber=5962-8864203YA&page=1&limit=20
```
- [ ] 验证：返回正确的元器件列表
- [ ] 验证：参数定义正确返回
- [ ] 验证：分页信息正确

#### ✅ 测试项 4.2.2：国产元器件搜索API
```bash
GET /api/domestic/search?keyword=xxx&page=1&limit=10
```
- [ ] 验证：返回正确的国产元器件列表
- [ ] 验证：分类筛选正确

#### ✅ 测试项 4.2.3：元器件对比API
```bash
# 进口元器件对比
POST /api/doeeet/components/compare
Body: { componentIds: ["id1", "id2"] }

# 国产元器件对比
POST /api/domestic/compare
Body: { componentIds: ["id1", "id2"] }
```
- [ ] 验证：返回正确的对比数据
- [ ] 验证：参数对比正确

#### ✅ 测试项 4.2.4：国产元器件附件API ⭐
```bash
# 附件索引
POST /api/domestic/attachments/reindex

# 获取附件信息
GET /api/domestic/attachments/:materialCode

# 下载附件
GET /api/domestic/attachments/:materialCode/download
```
- [ ] 验证：索引操作成功
- [ ] 验证：附件信息查询正确
- [ ] 验证：文件下载正常

### 4.3 分类树API

#### ✅ 测试项 4.3.1：进口分类树
```bash
GET /api/doeeet/categories/tree
```
- [ ] 验证：返回15个顶层分类
- [ ] 验证：分类层级正确

#### ✅ 测试项 4.3.2：国产分类树
```bash
GET /api/domestic/categories/tree
```
- [ ] 验证：返回11个一级分类
- [ ] 验证：分类层级正确（level1/2/3）

---

## 五、数据一致性测试

### 5.1 数据库连接测试

#### ✅ 测试项 5.1.1：MongoDB连接
- [ ] 验证：后端服务启动时成功连接 MongoDB
- [ ] 验证：数据库查询正常

#### ✅ 测试项 5.1.2：Redis连接（如使用）
- [ ] 验证：Redis 连接正常
- [ ] 验证：缓存功能正常

### 5.2 数据完整性测试

#### ✅ 测试项 5.2.1：标准数据
- [ ] 验证：标准数据总数正确（2173+）
- [ ] 验证：标准附件索引数量正确（5557+）

#### ✅ 测试项 5.2.2：元器件数据
- [ ] 验证：进口元器件数据总数正确（1.8M+）
- [ ] 验证：国产元器件数据完整
- [ ] 验证：国产元器件附件索引正确（286+）

### 5.3 文件匹配测试

#### ✅ 测试项 5.3.1：标准文件匹配
- [ ] 验证：标准编号与文件名精确匹配
- [ ] 验证：版本信息正确处理
- [ ] 验证：normalize 函数正确处理文件名

#### ✅ 测试项 5.3.2：国产元器件附件匹配
- [ ] 验证：material_code 与文件名精确匹配
- [ ] 验证：文件名不包含 .pdf 后缀

---

## 六、错误处理测试

### 6.1 前端错误处理

#### ✅ 测试项 6.1.1：API错误处理
- [ ] **网络错误**
  - 断开网络后操作
  - 验证：显示友好的错误提示

- [ ] **404错误**
  - 访问不存在的资源
  - 验证：显示正确的错误信息

- [ ] **500错误**
  - 模拟服务器错误
  - 验证：显示友好的错误提示

#### ✅ 测试项 6.1.2：空数据处理
- [ ] **空搜索结果**
  - 搜索不存在的关键词
  - 验证：显示"暂无数据"提示

- [ ] **空字段处理**
  - 验证：空字段不会导致页面崩溃
  - 验证：显示友好的占位符

### 6.2 后端错误处理

#### ✅ 测试项 6.2.1：参数验证
- [ ] **缺少必需参数**
  - 测试缺少必需参数的请求
  - 验证：返回400错误和错误信息

- [ ] **参数格式错误**
  - 测试格式错误的参数
  - 验证：返回422错误和错误信息

#### ✅ 测试项 6.2.2：文件操作错误
- [ ] **文件不存在**
  - 请求不存在的文件
  - 验证：返回404错误

- [ ] **文件读取错误**
  - 模拟文件读取失败
  - 验证：返回500错误和错误信息

---

## 七、性能测试（基础）

### 7.1 响应时间测试

#### ✅ 测试项 7.1.1：搜索响应时间
- [ ] **标准搜索**
  - 验证：响应时间 < 2秒

- [ ] **元器件搜索**
  - 验证：响应时间 < 3秒（大数据量）

- [ ] **分类树加载**
  - 验证：响应时间 < 1秒

#### ✅ 测试项 7.1.2：详情页加载
- [ ] **标准详情**
  - 验证：响应时间 < 1秒

- [ ] **元器件详情**
  - 验证：响应时间 < 2秒

### 7.2 分页性能测试

#### ✅ 测试项 7.2.1：大数据量分页
- [ ] **标准列表分页**
  - 测试第1页、中间页、最后一页
  - 验证：分页响应时间合理

- [ ] **元器件列表分页**
  - 测试不同页数
  - 验证：分页响应时间合理

---

## 八、浏览器兼容性测试（基础）

### 8.1 Chrome浏览器测试

#### ✅ 测试项 8.1.1：核心功能
- [ ] 标准查询功能
- [ ] 元器件搜索功能
- [ ] 文件下载功能
- [ ] 详情页显示

### 8.2 Firefox浏览器测试

#### ✅ 测试项 8.2.1：核心功能
- [ ] 标准查询功能
- [ ] 元器件搜索功能
- [ ] 文件下载功能

---

## 测试执行记录

### 测试日期：___________

### 测试人员：___________

### 测试结果汇总

| 模块 | 测试项数 | 通过 | 失败 | 跳过 | 通过率 |
|------|---------|------|------|------|--------|
| 标准服务 | 15 | | | | |
| 进口元器件搜索 | 18 | | | | |
| 国产元器件搜索 | 15 | | | | |
| 首页功能 | 4 | | | | |
| API接口 | 12 | | | | |
| 数据一致性 | 6 | | | | |
| 错误处理 | 6 | | | | |
| 性能测试 | 4 | | | | |
| 浏览器兼容性 | 2 | | | | |
| **总计** | **82** | | | | |

### 发现的问题

#### 严重问题（P0）
1. 
2. 
3. 

#### 一般问题（P1）
1. 
2. 
3. 

#### 轻微问题（P2）
1. 
2. 
3. 

### 测试结论

- [ ] 所有核心功能正常，可以打包
- [ ] 存在严重问题，需要修复后再打包
- [ ] 存在一般问题，建议修复后再打包

### 备注

---

## 测试工具推荐

### API测试工具
- Postman
- curl
- httpie

### 浏览器测试工具
- Chrome DevTools
- Firefox Developer Tools

### 性能测试工具
- Chrome DevTools Performance
- Lighthouse

---

## 快速测试脚本（可选）

可以创建自动化测试脚本，快速验证核心功能：

```bash
# 标准搜索测试
curl "http://localhost:3001/api/standards/search?standardType=MIL&page=1&limit=20"

# 标准附件测试
curl "http://localhost:3001/api/standards/MIL-STD-883H/attachment"

# 元器件搜索测试
curl "http://localhost:3001/api/doeeet/search?page=1&limit=20"

# 国产元器件搜索测试
curl "http://localhost:3001/api/domestic/search?page=1&limit=10"
```

---

**最后更新**: 2025-12-16
**版本**: v1.0

